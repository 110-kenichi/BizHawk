This code was copied from the NRage Input Plugin v2.0

https://sourceforge.net/projects/nragev20/